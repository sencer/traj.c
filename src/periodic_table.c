#include "periodic_table.h"


static unsigned char ELEMENTS[][3] = {
  "X", "H",  "He", "Li", "Be", "B",  "C",  "N",  "O",  "F",  "Ne", "Na", "Mg",
  "Al", "Si", "P",  "S",  "Cl", "Ar", "K",  "Ca", "Sc", "Ti", "V",  "Cr", "Mn",
  "Fe", "Co", "Ni", "Cu", "Zn", "Ga", "Ge", "As", "Se", "Br", "Kr", "Rb", "Sr",
  "Y",  "Zr", "Nb", "Mo", "Tc", "Ru", "Rh", "Pd", "Ag", "Cd", "In", "Sn", "Sb",
  "Te", "I",  "Xe", "Cs", "Ba", "La", "Ce", "Pr", "Nd", "Pm", "Sm", "Eu", "Gd",
  "Tb", "Dy", "Ho", "Er", "Tm", "Yb", "Lu", "Hf", "Ta", "W", "Re", "Os", "Ir",
  "Pt", "Au", "Hg", "Tl", "Pb", "Bi", "Po", "At", "Rn", "Fr", "Ra", "Ac", "Th",
  "Pa", "U",  "Np", "Pu", "Am", "Cm", "Bk", "Cf", "Es", "Fm", "Md", "No", "Lr",
  "Rf", "Db", "Sg", "Bh", "Hs", "Mt", "Ds", "Rg", "Cn","Nh", "Fl", "Mc", "Lv",
  "Ts", "Og"
};

// This is to implement a simple hash table for { element_sym: atomic_number }
// returns a unique integer for each element symbol
static unsigned int hash(unsigned char *chr)
{
  if (strlen((char*)chr) == 1)
  {
    return chr[0] + 353;
  }
  else
  {
    return (chr[0]-66) + 20 * ( chr[1]-97 );
  }
}

unsigned char *PT_Symbol(int Z)
{
 return ELEMENTS[Z];
}

unsigned int  PT_AtomicNumber(unsigned char *chr)
{
  const int hash_table[] = {
    56,  20, -1, -1,  -1,  31,  -1,  -1,  -1,  -1,  57,  -1, 11,  -1, 91,  -1,
    88,  -1, 73, -1,  -1,  -1,  105, -1,  -1,  -1,  -1,  -1, -1,  -1, -1,  -1,
    41,  -1, 82, -1,  37,  51,  65,  89,  -1,  -1,  -1,  70, -1,  -1, -1,  -1,
    -1,  -1, -1, 115, -1,  -1,  -1,  -1,  -1,  21,  43,  -1, -1,  48, -1,  -1,
    -1,  64, -1, -1,  -1,  -1,  -1,  101, 60,  -1,  46,  -1, -1,  -1, -1,  -1,
    4,   58, -1, -1,  26,  32,  2,   -1,  -1,  -1,  -1,  -1, 10,  -1, -1,  -1,
    75,  34, 52, -1,  -1,  98,  54,  -1,  -1,  -1,  72,  -1, -1,  -1, -1,  -1,
    -1,  -1, -1, -1,  104, -1,  -1,  47,  -1,  -1,  -1,  -1, -1,  -1, 80,  -1,
    -1,  -1, -1, 12,  -1,  118, -1,  -1,  111, 106, -1,  -1, 107, -1, -1,  -1,
    -1,  -1, -1, -1,  -1,  -1,  -1,  -1,  113, -1,  -1,  -1, 45,  -1, 90,  -1,
    83,  -1, -1, -1,  -1,  -1,  -1,  -1,  -1,  -1,  3,   -1, 28,  -1, -1,  -1,
    -1,  14, 22, -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1, -1,  -1, -1,  -1,
    -1,  -1, -1, -1,  -1,  -1,  -1,  -1,  97,  -1,  -1,  -1, -1,  -1, -1,  -1,
    -1,  -1, -1, -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  13, -1,  17, -1,  -1,
    114, -1, -1, -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1, -1,  -1, 81,  95,
    -1,  96, -1, -1,  100, -1,  -1,  -1,  -1,  -1,  -1,  -1, -1,  -1, 61,  -1,
    -1,  62, 69, -1,  -1,  112, -1,  -1,  -1,  -1,  -1,  49, -1,  -1, -1,  25,
    -1,  -1, -1, -1,  86,  50,  -1,  -1,  -1,  27,  -1,  -1, 30,  -1, 67,  -1,
    -1,  -1, -1, 42,  102, -1,  84,  -1,  -1,  -1,  -1,  -1, -1,  -1, -1,  -1,
    -1,  -1, -1, -1,  -1,  -1,  -1,  -1,  93,  -1,  -1,  -1, -1,  -1, -1,  -1,
    -1,  -1, -1, -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1, -1,  -1, -1,  -1,
    -1,  -1, -1, 18,  35,  24,  -1,  68,  87,  -1,  -1,  77, -1,  36, 103, -1,
    -1,  -1, 59, -1,  -1,  38,  -1,  33,  -1,  55,  110, 99, 40,  -1, 108, -1,
    -1,  -1, -1, -1,  -1,  76,  -1,  -1,  -1,  -1,  117, 85, -1,  -1, -1,  -1,
    -1,  -1, -1, -1,  -1,  -1,  -1,  109, -1,  -1,  78,  -1, -1,  -1, -1,  79,
    -1,  29, -1, 63,  -1,  -1,  -1,  -1,  -1,  -1,  71,  -1, -1,  -1, 94,  -1,
    44,  -1, -1, 5,   6,   -1,  -1,  9,   -1,  1,   53,  -1, 19,  -1, 116, 7,
    8,   15, -1, -1,  16,  -1,  92,  23,  74,  0,   39,  -1, -1,  -1, -1,  -1,
    -1,  -1, -1, -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1, -1,  -1, -1,  -1,
    -1,  -1, -1, -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1, -1,  -1, -1,  -1,
    -1,  -1, 65
  };

  return hash_table[hash(chr)];
}

// vi: fdm=syntax
